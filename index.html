<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Hello! Wow!</title>
    <script src="js/phaser.js"></script>
    <script src="js/main.js"></script>

<style>
body
{
    color: #777;
    font-family: "Avenir", Verdana, sans-serif;
}
#readme
{
    margin-top: 10px;
}
</style>

</head>
<body>


<script type="text/javascript">

var game = new Phaser.Game(800, 600, Phaser.AUTO, '', { preload: preload, create: create, update: update });

function preload() {


    game.load.image('mini', 'assets/miniledge.png');
    game.load.image('ground', 'assets/ground.png');
    game.load.image('building', 'assets/building.png');
    game.load.image('ledge', 'assets/ledge.png');
    game.load.image('dog', 'assets/dog.png');
    game.load.spritesheet('catcher', 'assets/catcher.png', 43, 50);

}


var dogs;
var ground;
var player;
var platforms;
var cursors;
var score = 0;
var scoreText;
var button;

function create() {

	
    //  We're going to be using physics, so enable the Arcade Physics system
    game.physics.startSystem(Phaser.Physics.ARCADE);

    //  A simple background for our game
    game.add.sprite(0, 0, 'building');

    //  The platforms group contains the ground and the 2 ledges we can jump on
    platforms = game.add.group();

    //  We will enable physics for any object that is created in this group
    platforms.enableBody = true;

    // Here we create the ground.
         //var ground = platforms.create(0, game.world.height, 'ground');

    //  Scale it to fit the width of the game (the original sprite is 400x32 in size)
        //ground.scale.setTo(2, 2);

    //  This stops it from falling away when you jump on it
        //  ground.body.immovable = true;

    //  Now let's create two ledges
    var ledge = platforms.create(30, 260, 'ledge');
    ledge.body.immovable = true;

    ledge = platforms.create(230, 260, 'ledge');
    ledge.body.immovable = true;

    ledge = platforms.create(430,260, 'ledge');
    ledge.body.immovable = true;

    ledge = platforms.create(630,260, 'ledge');
    ledge.body.immovable = true;

    ledge = platforms.create(30,560, 'ledge');
    ledge.body.immovable = true;

    ledge = platforms.create(230,560, 'ledge');
    ledge.body.immovable = true;

    ledge = platforms.create(430,560, 'ledge');
    ledge.body.immovable = true;

    ledge = platforms.create(630,560, 'ledge');
    ledge.body.immovable = true;

    ledge = platforms.create(175,400, 'mini');
    ledge.body.immovable = true;

    ledge = platforms.create(375,400, 'mini');
    ledge.body.immovable = true;

    ledge = platforms.create(575,400, 'mini');
    ledge.body.immovable = true;
   

    // The player and its settings
    player = game.add.sprite(32, game.world.height - 150, 'catcher');

    //  We need to enable physics on the player
    game.physics.arcade.enable(player);

    //  Player physics properties. Give the little guy a slight bounce.
    player.body.gravity.y = 300;
    player.body.collideWorldBounds = false;
    player.body.setSize(20, 40, 20, 10);


    //  Our controls.
    cursors = game.input.keyboard.createCursorKeys();

    player.animations.add('left', [0, 1, 2], 10, true);
    player.animations.add('right', [4, 5, 6], 10, true);

    dogs = game.add.group();

    dogs.enableBody = true;

    dogs.createMultiple(100, 'dog', 0, false);
/*
    for (var i = 0; i < 4; i++){

    var dog = dogs.create(100 + (i*200), 240, 'dog');

    }

    for (var i = 0; i < 4; i++){

    var dog = dogs.create(100 + (i*200), 540, 'dog');

    }
*/
    game.time.events.repeat(Phaser.Timer.SECOND, 100, resurrect, this);

    scoreText = game.add.text(300, 5, 'Dogs Captured: 0', { fontSize: '32px',fill: '#00ff00' });


}

function update() {

    //  Collide the player and the stars with the platforms
    game.physics.arcade.collide(player, platforms);

    //  Reset the players velocity (movement)
    player.body.velocity.x = 0;

    if (cursors.left.isDown)
    {
        //  Move to the left
        player.body.velocity.x = -150;

        player.animations.play('left');
    }
    else if (cursors.right.isDown)
    {
        //  Move to the right
        player.body.velocity.x = 150;

        player.animations.play('right');
    }
    else
    {
        //  Stand still
        player.animations.stop();

        player.frame = 4;
    }
    
    //  Allow the player to jump if they are touching the ground.
    if (cursors.right.isDown && player.body.touching.down && cursors.up.isDown)
    {
        player.body.velocity.y = -150;
    }
    else if (cursors.left.isDown && player.body.touching.down && cursors.up.isDown)
    {
        player.body.velocity.y = -150;
    }
    else if (cursors.up.isDown && player.body.touching.down)
    {
        player.body.velocity.y = -330;
    }


    //game.physics.arcade.collide(stars, platforms);

    game.physics.arcade.overlap(player, dogs, captureDog, null, this);

    game.physics.arcade.collide(player, ground, collisionHandler, null, this);


}

function resurrect() {

    //  Get a dead item
    var item = dogs.getFirstDead();

    if (item)
    {
        //  And bring it back to life
        item.reset((100 + (200*game.rnd.integerInRange(0, 3)) + (5*game.rnd.integerInRange(-10,10))), (240 + (300*game.rnd.integerInRange(0,1))));

        //  This just changes its frame
        item.frame = game.rnd.integerInRange(0, 36);
    }

}
function collisionHandler (obj1, obj2) {

    game.stage.backgroundColor = '#992d2d';

}


function captureDog (player, dog) {
    
    // Removes the star from the screen
    dog.kill();

    //  Add and update the score
    score += 1;
    scoreText.text = 'Dogs Captured: ' + score;

}

</script>
<div id="game"></div>
<div id="readme">
<h2>Your game title</h2>
<ul>

<li><strong>High Concept:</strong>
A one-sentence summary of your game.
</li>

<li><strong>Player Experience Goals:</strong>
What experience do you want players to have when playing your game?
</li>

<li><strong>Genre:</strong>
A single sentence that places the game within a game genre or a hybrid of genres.
</li>

<li><strong>Game play:</strong>
A paragraph describing the actions the player can perform, the system dynamics, and the core mechanic. Include a concise explanation of the prototypeâ€™s inputs and their expected effects (how to play). You can also describe game play that is not in the prototype. You may include mock-up images for parts of the game not in the prototype.
</li>

<li><strong>Prototype goal:</strong>
What game mechanic is this prototype evaluating?
</li>

<li><strong>Features:</strong>
What are the unique aspects of your game that set it apart?
</li>

<li><strong>Setting/Premise:</strong>
A paragraph about the world your game is set in and who the characters are. What makes the game world and its occupants unique and interesting? Do the tokens represent something? If the game has a backstory, put it here. If the game is abstract, then say so.
</li>

<li><strong>Story:</strong>
If the game has a story, summarize it in a paragraph. How will the dramatic tension interact with the gameplay tension?
</li>

<li><strong>Target Audience:</strong>
A single sentence that describes the demographic you're trying to reach.
</li>

<li><strong>Play time:</strong>
How long does your game take to play?
</li>

<li><strong>Strategies:</strong>
What player strategies do you expect will be effective at playing this game?
</li>

<li><strong>Prototype Assets:</strong>
Did you make your prototype assets from scratch? Did you borrow them? Cite your sources here.
</li>

<li><strong>Prototype Closest Other Game:</strong>
Which other game most closely resembles your game? If you are borrowing from a Phaser Example, you must say so here.
</li>

</ul>
</div>
</body>
</html>
